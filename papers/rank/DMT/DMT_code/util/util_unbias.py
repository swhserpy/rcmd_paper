import numpy as np
propensity_em =[1, 0.438141907, 0.470354498, 0.22337097, 0.322102835, 0.23286324, 0.229156121, 0.179937005, 0.207471298, 0.214811033, 0.186198205, 0.178980724, 0.174483616, 0.149089977, 0.161579815, 0.142268534, 0.137564522, 0.145614037, 0.161346063, 0.141194783, 0.136287104, 0.000661781, 0.120995661, 0.114672193, 0.125490005, 0.106242161, 0.128567333, 0.132799019, 0.120335995, 0.123238237, 0.114449142, 0.230883708, 0.152788358, 0.130623959, 0.109092714, 0.113445091, 0.103691325, 0.126693205, 0.108134485, 0.114113291, 0.107701851, 0.107733855, 0.120244572, 0.098095929, 0.092957189, 0.132702331, 0.088456472, 0.071128244, 0.095548309, 0.093838672, 0.093312152, 0.099791978, 0.099887599, 0.086562006, 0.09298353, 0.097939965, 0.084014962, 0.086793623, 0.08827469, 0.093292141, 0.091941566, 0.116466359, 0.097904473, 0.083095107, 0.07901647, 0.092284486, 0.081167242, 0.067222955, 0.083864807, 0.090114573, 0.082359664, 0.10076446, 0.08456345, 0.071854448, 0.083572246, 0.076532802, 0.088542061, 0.077725351, 0.075616375, 0.083830037, 0.08141136, 0.080333031, 0.07761418, 0.066615814, 0.067997205, 0.085175226, 0.072349636, 0.07114335, 0.077787295, 0.079011167, 0.074114033, 0.058256506, 0.074104515, 0.095954567, 0.06945064, 0.068951852, 0.07606098, 0.067622872, 0.076869953, 0.066716362, 0.068148943, 0.082340364, 0.057566844, 0.067036706, 0.062519936, 0.054657796, 0.074660191, 0.062349055, 0.066208461, 0.068096531, 0.062155405, 0.082821097, 0.067378787, 0.052002629, 0.068988219, 0.065260573, 0.061370323, 0.057204554, 0.062524431, 0.06921285, 0.060616661, 0.057799414, 0.072202074, 0.073330905, 0.059482896, 0.05072299, 0.058849407, 0.055455853, 0.061320908, 0.061998328, 0.063411631, 0.071235704, 0.065095977, 0.040760698, 0.055003377, 0.06099506, 0.062204262, 0.038036138, 0.056578115, 0.05229865, 0.061148699, 0.070975169, 0.062115273, 0.049736221, 0.06728433, 0.047779393, 0.063565579, 0.070831754, 0.053457753, 0.059255238, 0.054131307, 0.062957591, 0.066819156, 0.053440288, 0.057572805, 0.054884885, 0.042188044, 0.05740406, 0.05613244, 0.053955554, 0.04839913, 0.045304702, 0.069757627, 0.062325464, 0.049778029, 0.038694718, 0.05327659, 0.046146842, 0.054530156, 0.063992923, 0.053156292, 0.037516539, 0.055952738, 0.051528176, 0.044955421, 0.028192811, 0.038800959, 0.041924406, 0.058795194, 0.052328328, 0.057802538, 0.06839423, 0.065050947, 0.07327935, 0.054761906, 0.051049352, 0.063479169, 0.05680117, 0.065074258, 0.055364042, 0.051162207, 0.070367625, 0.048638111, 0.058846704, 0.045385248, 0.055400027, 0.03435732, 0.070603186, 0.059792558, 0.063638091, 0.052665431, 0.039794042, 0.060741619, 0.063143647, 0.048073954, 0.032895184, 0.032194911, 0.094518531, 0.053443039, 0.054837097, 0.058122478, 0.101457752, 0.049528774, 0.063366687, 0.059003659, 0.043921362, 0.038390351, 0.017054501, 0.056425062, 0.070018963, 0.053181625, 0.042862656, 0.049756643, 0.051766691, 0.047255415, 0.02969181, 0.0688122, 0.056487917, 0.048366127, 0.04917083, 0.072882717, 0.079556373, 0.051645243, 0.054707468, 0.041868792, 0.074383203, 0.075072621, 0.07525659, 0.050211565, 0.039144152, 0.044505727, 0.054036563, 0.058217611, 0.056717641, 0.058849184, 0.045058629, 0.067818468, 0.09145774, 0.054405747, 0.04879973, 0.058559586, 0.02188006, 0.045607786, 0.0666498, 0.054620634, 0.057841469, 0.030823588, 0.02814164, 0.057956524, 0.056237862, 0.042403833, 0.07972519, 0.063003242, 0.009369996, 0.059267217, 0.035596661, 0.033262717, 0.07006414, 0.035988143, 0.057421826, 0.056445488, 0.065031869, 0.041772691, 0.040590338, 0.046797296, 0.076407335, 0.032024643, 0.04298576, 0.037011378, 0.068678664, 0.064189797, 0.065121015, 0.060157592, 0.036671004, 0.045060875, 0.054959408, 0.05555713, 0.049940267, 0.056019508, 0.043551373, 0.039420706, 0.042571363, 0.040161929, 0.033661629, 0.060404646, 0.031775678, 0.025738987, 0.056209624, 0.072685539, 0.038951552, 0.061449387, 0.033293709, 0.055084403, 0.013068927, 0.051938228, 0.049458594, 0.055612892, 0.027846704, 0.03713007, 0.015304935, 0.033420503, 0.051093446, 0.044647614, 0.048101163, 0.046122092, 0.025120893, 0.055568262, 0.048496694, 0.048544729, 0.035314319, 0.063131638, 0.030461685, 0.044919969, 0.029698369, 0.057471746, 0.095493165, 0.029382579, 1.03E-05, 0.036340128, 0.041954342, 0.059683726, 0.139948607, 0.046170185, 0.018917743, 0.024012347, 0.027812439, 0.050400429, 0.043973696, 0.025760958, 0.050556379, 0.045867939, 0.092786073, 0.028550307, 0.036742354, 0.051285855, 1.09E-05, 0.027757445, 7.49E-06, 0.058737357, 0.085964102, 0.053374349, 0.020462867, 0.027791829, 0.042403328, 0.045296993, 0.030513499, 0.028670492, 0.062471534, 0.030867535, 0.035695048, 0.070279307, 0.041009534, 0.062369159, 0.071300862, 0.043628472, 5.29E-06, 0.040551104, 0.062980095, 0.079198708, 0.037985231, 0.066581203, 0.040363638, 0.039061663, 0.044509257, 0.037497384, 0.035222286, 0.028992797, 2.71E-06, 0.045209948, 0.029181613, 0.0375277, 3.84E-06, 0.043631634, 2.79E-06, 0.015821188, 0.093206306, 0.019573861, 0.181389401, 0.025640794, 0.010578953, 0.047213052, 0.068282613, 0.020410327, 0.08091245, 0.032363388, 0.047028691, 0.028544365, 0.09130486, 0.068008078, 2.28E-07, 0.047932977]
print(len(propensity_em))

propensity_em_position = [1.0, 1.0, 0.9977208683489958, 0.995273922385592, 0.9930783066020896, 0.9905798138866997, 0.9882670594755637, 0.98584849706744, 0.98358906374613, 0.9812316387462217, 0.9788838377340568, 0.9761800195463444, 0.9739336835478871, 0.9711405985236595, 0.9692003253459818, 0.9665583309599011, 0.9644981953880655, 0.9619547340342993, 0.9596577125154235, 0.9571362670959229, 0.9548924135108984, 0.9526329616208071, 0.9499827968831988, 0.9474701890321366, 0.9451700753441604, 0.9425716820778802, 0.9406625711880219, 0.9382197147320457, 0.9356565769325362, 0.933250409431704, 0.9309838229274456, 0.9290580380478958, 0.9261430952935085, 0.9229237235078256, 0.9211651503697936, 0.9195416053830752, 0.9168261428255524, 0.9143690241252318, 0.9117928550338331, 0.9097885375752125, 0.9072545792811828, 0.9040061625352553, 0.901866504546, 0.8996503587772423, 0.8972183440710769, 0.8953498413686616, 0.8922315752188354, 0.8893434711733562, 0.8879783304589086, 0.8854749487944306, 0.8832707299230528, 0.8824435381387925, 0.8783897555943987, 0.8760056148315503, 0.8741848935511249, 0.8702872090326247, 0.8677308310828098, 0.8666202347408071, 0.8643499256819923, 0.8619729599349818, 0.8595181222563197, 0.8556975447284741, 0.8547372987574736, 0.8528499100209027, 0.8507190524484273, 0.8482664617224298, 0.8461336478554394, 0.8437809346339782, 0.8413109731989418, 0.8395211079470042, 0.8366550154035246, 0.8337111959674944, 0.8318217043420086, 0.827906209335685, 0.827210509837853, 0.8233118506119242, 0.82186836466497, 0.8195074450956872, 0.8176331531301617, 0.815588858947034, 0.8130148541184067, 0.8103682777366921, 0.8081665441293833, 0.8067844601422479, 0.8046529374883543, 0.8035672410903045, 0.7995770057329193, 0.7962681982043732, 0.7948482650370501, 0.793116327312035, 0.7896821590344203, 0.7879129675119965, 0.7857675506929764, 0.7829973597494492, 0.7818092015699433, 0.7786970461884937, 0.7775902846337068, 0.7743788931392719, 0.7719507777005827, 0.7709908694383898, 0.7668118916623549, 0.7642620619470011, 0.7632963324344447, 0.7614939995014457, 0.7584282440472181, 0.7555960016212968, 0.7553515195110669, 0.7516751775550894, 0.7492477975085476, 0.7473365504681634, 0.7459929492583139, 0.7426754082221902, 0.7415358850609232, 0.7361037676835535, 0.7359124555501738, 0.7331096312270765, 0.7304308519311778, 0.7293000254736103, 0.7270994570450645, 0.7248567525256258, 0.7233735658773969, 0.727554350608602, 0.7182161211663292, 0.7140727413340904, 0.7131280076689541, 0.7105909646704108, 0.7076689309005648, 0.70541886634538, 0.7060312311274183, 0.7013633984015553, 0.7020329334086015, 0.6968561415285268, 0.6965876396552745, 0.6952210179549583, 0.6923882232934808, 0.6891068506171149, 0.68997066044889, 0.6828605020645112, 0.6830037200836765, 0.6805378401812074, 0.6765431527618814, 0.6791838470394543, 0.6777366552463006, 0.672155232666332, 0.6711925724101336, 0.6690492006860457, 0.6652618637892409, 0.6637157888692192, 0.6607831813611905, 0.6612829186304212, 0.6576000614947545, 0.6567978443599249, 0.6527427047067963, 0.6548580288301147, 0.6483391059532525, 0.6495987616814646, 0.6440243336005842, 0.6430823049883009, 0.6387746994008326, 0.636175726704009, 0.6356741247977972, 0.6336289020638858, 0.6318054629397691, 0.6337205183212445, 0.6282593246298681, 0.6268122253126025, 0.6210244125179686, 0.619413944283801, 0.6188322831441576, 0.6166894057804131, 0.6158600808479481, 0.6069953540723678, 0.6092857338073467, 0.6084032046194008, 0.6057895264699141, 0.6007667468633618, 0.6029158500486479, 0.601055272349074, 0.5969062662190934, 0.5958870965240352, 0.596163995762857, 0.5961353172675714, 0.5893027154643506, 0.5898936567726267, 0.5854676669960411, 0.5902514476103157, 0.5809191088131413, 0.5826189433041411, 0.5767531414378722, 0.5797150413006805, 0.5712014166688041, 0.5692955298760991, 0.5703070804921979, 0.563189141772388, 0.562529818699149, 0.5617902842534672, 0.5644716931227939, 0.5550028616643659, 0.5576380910227267, 0.550627918365669, 0.5526395548189915, 0.5493529575726801, 0.5496998532497499, 0.551085174905474, 0.545610352132884, 0.5386396086750509, 0.5360867892404166, 0.5425115254462466, 0.5315745040666277, 0.5334038261372365, 0.5335634879388528, 0.5297909306919347, 0.5265109095966861, 0.5228493972374522, 0.5205565280065627, 0.5187202657544383, 0.5226572615268729, 0.5192041593155615, 0.5146759381726514, 0.5139346565770617, 0.5183094685426328, 0.5161091188397798, 0.5068724281773168, 0.49907492208379467, 0.5050602062748071, 0.49935909509379434, 0.4979543981743885, 0.5056577913135883, 0.49347547693792504, 0.4939212165914598, 0.4919933669842999, 0.4903305984223354, 0.48837594063011935, 0.48307506971792696, 0.4818945506591571, 0.48984531744687193, 0.4789153636248687, 0.47085868419618165, 0.4748081384060097, 0.47038731297152936, 0.47699200727058083, 0.46283341981269666, 0.46506598367856733, 0.4695759686396583, 0.46905419445935187, 0.45985372681977515, 0.45932125510204924, 0.45663223854418167, 0.45475079920929107, 0.4561810339149534, 0.452518304252637, 0.44270127053812985, 0.44200080345516246, 0.45072316499154813, 0.44036024383352546, 0.45437975455654156, 0.4329328604935265, 0.43121697388919505, 0.4371291208859954, 0.43468709454290383, 0.4322265558322107, 0.44351929493086323, 0.428205839755481, 0.4256959830256811, 0.4237344200199427, 0.43782415548939924, 0.4214658127145292, 0.4303768999017523, 0.41893614440586796, 0.4182373975098336, 0.4187698771735336, 0.4032652631217032, 0.4064102136786447, 0.39978583319275285, 0.4061858136368854, 0.4040976391704298, 0.4062772022795965, 0.39180107277784404, 0.3987345424445632, 0.40044905938981357, 0.39335515194179743, 0.3844770117201338, 0.3894605843298965, 0.3889005538170962, 0.38821429562184157, 0.3767617252177045, 0.3793869260155179, 0.3730825838953668, 0.37688900781332707, 0.37596981151698594, 0.37237431290319395, 0.36503879853399157, 0.3692680955067515, 0.38132438795313184, 0.3631797956079477, 0.36997311264262017, 0.35584625965382066, 0.3539658010492566, 0.3610933420286413, 0.3552565328885221, 0.3569080551406266, 0.34664619734164287, 0.3520158526201159, 0.3427108852414265, 0.342767245633939, 0.3673472622676705, 0.33911178540521386, 0.3347665823300255, 0.33843298090851465, 0.3371008146983266, 0.33969886230112867, 0.3417687263407447, 0.3254584824551801, 0.32372459837878764, 0.3308825559943529, 0.31989899440631886, 0.33080743593134926, 0.3160739422667797, 0.3234759308878287, 0.3160414098263122, 0.3187903251296512, 0.30876690110735283, 0.3202303247794688, 0.3505211676325221, 0.3135255900572267, 0.30173027351256293, 0.3053421897644672, 0.2984499358370243, 0.31226751236868555, 0.308958087947006, 0.2963848050684678, 0.2904034407157221, 0.2944202842713481, 0.32390301794709264, 0.29030223714580994, 0.2988737224165566, 0.2877034074268318, 0.3005183688055055, 0.28473707582123475, 0.2796393840884353, 0.27929363598172474, 0.29172767750795425, 0.27376096417019585, 0.284665613548302, 0.27276652565612597, 0.2826788535588865, 0.266585763552693, 0.2608308238043342, 0.25934607506103646, 0.26269357009410543, 0.255755298488263, 0.25394830587211, 0.2594082171929788, 0.2502887727086453, 0.2633953516951089, 0.2467105941887545, 0.24910967911263282, 0.24307196394691097, 0.2554424280195333, 0.24531693466780177, 0.2509397643979343, 0.23606061509200246, 0.24707447263032437, 0.2320455606054042, 0.23458350216271226, 0.22862729738881962, 0.227108132040897, 0.22554234204671922, 0.23414146291358037, 0.22152065031695417, 0.2281202606731824, 0.21814146819575006, 0.23941488674491554, 0.2377833837060432, 0.22194468267458728, 0.21075431122315605, 0.20916129687242396, 0.20759246227520056, 0.20574555463369204, 0.2189701749257758, 0.20228869970852673, 0.2004772050002584, 0.21787713434100292, 0.19726766772540544, 0.2002799906087005, 0.19384591696984982, 0.20290177055489678, 0.18980056509864332, 0.2024537685107527, 0.1943271839354795, 0.1846191009599262, 0.21338852585244958, 0.1922586116242148, 0.17938221546380578, 0.18286016762422594, 0.176009240260375, 0.18623340171991573, 0.17241292223705118, 0.1782475893437099, 0.17789986292883872, 0.17663411337598978]
print(len(propensity_em_position))

propensity_em_page = [1.0, 1.0, 0.9882803625892872, 0.9763998543192146, 0.964518164928909, 0.9526407905738569, 0.9407946094202257, 0.9291787148107138, 0.917358990481255, 0.9055010051164688, 0.8938272773538753, 0.8823433011679306, 0.8707426765204269, 0.8592833338777892, 0.8475122745164366, 0.836209813310267, 0.824940492063829, 0.8139980881980676, 0.8026647578402912, 0.7909316055064669, 0.7794589804778954, 0.7686348686832023, 0.7574575737241317, 0.7466115232226941, 0.7355760411191061, 0.7247883075650642, 0.7133113723786403, 0.7031985929526289, 0.6916375473734097, 0.6835606838185663, 0.6700937320896512, 0.660890650120072, 0.6485400910694438, 0.6400447414463936, 0.6279240352103173, 0.6186449616369601, 0.6051358924491744, 0.5988282721219996, 0.584265685495023, 0.5756929141951282, 0.5646367436927915, 0.5555498156056383, 0.5428269230106476, 0.5393690786636164, 0.5282462625725356, 0.5152223600599257, 0.5041676100824631, 0.49694154327974366, 0.48586058096816775, 0.47479330916914747, 0.4654706275173157, 0.456127135610103, 0.4432564590078725, 0.4356903295095868, 0.42405431347406664, 0.4198017472855328, 0.407865385963443, 0.3937262387621717, 0.39438821033503657, 0.3786739982705832, 0.3615636527007544, 0.3565023017463844, 0.36991934748622796, 0.3380061967608792, 0.3297922161813123, 0.3270076688849393, 0.3298929882304274, 0.2958361317848641, 0.2945047086089182, 0.2771965224750156, 0.2768302647534643, 0.2587976561800741, 0.2714460134597369, 0.2621066075183268, 0.24619083504579312, 0.2224443603762162, 0.21354515822066045, 0.2047516929788015, 0.19590487001767262, 0.1869361882892023, 0.19737675536284358, 0.1689964820844562, 0.16047381891081208, 0.15182080725762195, 0.1430561513859541, 0.1637828719894431, 0.12587690400956258, 0.14083287148740428, 0.1644821323442298, 0.10018664729888277, 0.12408572301039227, 0.12345907643817651, 0.07452410098946277, 0.06619367672001111, 0.05775871782126436, 0.04937283300970018, 0.04111403952330643, 0.032838897871333664, 0.024551441123907308, 0.08884353387025773, 0.012845716560246063]
print(len(propensity_em_page))

propensity_em = propensity_em_position
a_propensity_em=np.array(propensity_em)
a_inv_propensity_em=1/a_propensity_em
a_inv_propensity_em_norm=np.clip(a_inv_propensity_em, 1, 10)
#print(a_inv_propensity_em_norm)